"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[2812],{19150:function(S,y,t){t.d(y,{R:function(){return f}});var e=t(20108),o=t(24989),h=t(33348);function f(c={},E={}){const{id:v="",...M}=c,P=(0,h.stringify)(M,{encode:!1}),{get:R}=(0,o.kY)(),{data:m,isError:n,isLoading:j,refetch:T}=(0,e.useQuery)(["users",v,M],async()=>{const{data:{data:D}}=await R(`/admin/users/${v}${P?`?${P}`:""}`);return D},E);let A=[];return v&&m?A=[m]:Array.isArray(m?.results)&&(A=m.results),{users:A,pagination:m?.pagination??null,isLoading:j,isError:n,refetch:T}}},83196:function(S,y,t){var e=t(32735),o=t(60216),h=t.n(o),f=t(67879),c=t(72850),E=t(41415),v=t(5644),M=t(24989);const P=({displayedFilters:R})=>{const[m,n]=(0,e.useState)(!1),{formatMessage:j}=(0,f.Z)(),T=(0,e.useRef)(),A=()=>{n(D=>!D)};return e.createElement(e.Fragment,null,e.createElement(c.x,{paddingTop:1,paddingBottom:1},e.createElement(E.z,{variant:"tertiary",ref:T,startIcon:e.createElement(v.Z,null),onClick:A,size:"S"},j({id:"app.utils.filters",defaultMessage:"Filters"})),m&&e.createElement(M.J5,{displayedFilters:R,isVisible:m,onToggle:A,source:T})),e.createElement(M.W$,{filtersSchema:R}))};P.propTypes={displayedFilters:h().arrayOf(h().shape({name:h().string.isRequired,metadatas:h().shape({label:h().string}),fieldSchema:h().shape({type:h().string})})).isRequired},y.Z=P},71765:function(S,y,t){t.r(y),t.d(y,{default:function(){return oe}});var e=t(32735),o=t(24989),h=t(83983),f=t(67879),c=t(96709),E=t(17e3),v=t(72850),M=t(27649),P=t(82055),R=t(99223),m=t(60216),n=t.n(m),j=t(35658),T=t(94547),A=t(19786),D=t(49372),_=t(87933),re=t(50563),ie=t(54894),X=t(96315),G=()=>{const{formatDate:s}=(0,f.Z)();return u=>{const l=(0,X.Z)(u),p=s(l,{dateStyle:"long"}),r=s(l,{timeStyle:"medium",hourCycle:"h24"});return`${p}, ${r}`}};const w={"entry.create":"Create entry{model, select, undefined {} other { ({model})}}","entry.update":"Update entry{model, select, undefined {} other { ({model})}}","entry.delete":"Delete entry{model, select, undefined {} other { ({model})}}","entry.publish":"Publish entry{model, select, undefined {} other { ({model})}}","entry.unpublish":"Unpublish entry{model, select, undefined {} other { ({model})}}","media.create":"Create media","media.update":"Update media","media.delete":"Delete media","media-folder.create":"Create media folder","media-folder.update":"Update media folder","media-folder.delete":"Delete media folder","user.create":"Create user","user.update":"Update user","user.delete":"Delete user","admin.auth.success":"Admin login","admin.logout":"Admin logout","content-type.create":"Create content type","content-type.update":"Update content type","content-type.delete":"Delete content type","component.create":"Create component","component.update":"Update component","component.delete":"Delete component","role.create":"Create role","role.update":"Update role","role.delete":"Delete role","permission.create":"Create permission","permission.update":"Update permission","permission.delete":"Delete permission"},Z=s=>w[s]||s,V=({headers:s,rows:g,onOpenModal:u})=>{const{formatMessage:l}=(0,f.Z)(),p=G(),r=({type:d,value:i,model:L})=>d==="date"?p(i):d==="action"?l({id:`Settings.permissions.auditLogs.${i}`,defaultMessage:Z(i)},{model:L}):i||"-";return e.createElement(j.p,null,g.map(d=>e.createElement(T.Tr,{key:d.id,...(0,o.X7)({fn:()=>u(d.id)})},s.map(({key:i,name:L,cellFormatter:C})=>e.createElement(A.Td,{key:i},e.createElement(D.Z,{textColor:"neutral800"},r({type:i,value:C?C(d[L]):d[L],model:d.payload?.model})))),e.createElement(A.Td,{...o.UW},e.createElement(_.k,{justifyContent:"end"},e.createElement(re.h,{onClick:()=>u(d.id),"aria-label":l({id:"app.component.table.view",defaultMessage:"{target} details"},{target:`${d.action} action`}),noBorder:!0,icon:e.createElement(ie.Z,null)}))))))};V.defaultProps={rows:[]},V.propTypes={headers:n().array.isRequired,rows:n().array,onOpenModal:n().func.isRequired};var le=V,de=[{name:"action",key:"action",metadatas:{label:{id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"},sortable:!0}},{name:"date",key:"date",metadatas:{label:{id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"},sortable:!0}},{key:"user",name:"user",metadatas:{label:{id:"Settings.permissions.auditLogs.user",defaultMessage:"User"},sortable:!1},cellFormatter:s=>s?s.displayName:""}];const U=({pagination:s})=>e.createElement(v.x,{paddingTop:4},e.createElement(_.k,{alignItems:"flex-end",justifyContent:"space-between"},e.createElement(o.v4,null),e.createElement(o.tU,{pagination:s})));U.defaultProps={pagination:{pageCount:0,pageSize:50,total:0}},U.propTypes={pagination:n().shape({page:n().number,pageCount:n().number,pageSize:n().number,total:n().number})};var a=U,x=t(20108),B=t(85025),Q=t(55225),W=t(11299),N=t(31600),ue=t(23866),ce=t(15335),me=t(88807);const F=({actionLabel:s,actionName:g})=>e.createElement(_.k,{direction:"column",alignItems:"baseline",gap:1},e.createElement(D.Z,{textColor:"neutral600",variant:"sigma"},s),e.createElement(D.Z,{textColor:"neutral600"},g));F.propTypes={actionLabel:n().string.isRequired,actionName:n().string.isRequired};var b=F;const H=({status:s,data:g,formattedDate:u})=>{const{formatMessage:l}=(0,f.Z)();if(s==="loading")return e.createElement(_.k,{padding:7,justifyContent:"center",alignItems:"center"},e.createElement(ue.a,null,"Loading content..."));const{action:p,user:r,payload:d}=g;return e.createElement(e.Fragment,null,e.createElement(v.x,{marginBottom:3},e.createElement(D.Z,{variant:"delta",id:"title"},l({id:"Settings.permissions.auditLogs.details",defaultMessage:"Log Details"}))),e.createElement(ce.r,{gap:4,gridCols:2,paddingTop:4,paddingBottom:4,paddingLeft:6,paddingRight:6,marginBottom:4,background:"neutral100",hasRadius:!0},e.createElement(b,{actionLabel:l({id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"}),actionName:l({id:`Settings.permissions.auditLogs.${p}`,defaultMessage:Z(p)},{model:d?.model})}),e.createElement(b,{actionLabel:l({id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"}),actionName:u}),e.createElement(b,{actionLabel:l({id:"Settings.permissions.auditLogs.user",defaultMessage:"User"}),actionName:r?.displayName||"-"}),e.createElement(b,{actionLabel:l({id:"Settings.permissions.auditLogs.userId",defaultMessage:"User ID"}),actionName:r?.id.toString()||"-"})),e.createElement(me.V,{value:JSON.stringify(d,null,2),disabled:!0,label:l({id:"Settings.permissions.auditLogs.payload",defaultMessage:"Payload"})}))};H.defaultProps={data:{}},H.propTypes={status:n().oneOf(["idle","loading","error","success"]).isRequired,data:n().shape({action:n().string,date:n().string,payload:n().object,user:n().object}),formattedDate:n().string.isRequired};var ge=H;const k=({handleClose:s,logId:g})=>{const{get:u}=(0,o.kY)(),l=(0,o.lm)(),p=async C=>{const{data:$}=await u(`/admin/audit-logs/${C}`);if(!$)throw new Error("Audit log not found");return $},{data:r,status:d}=(0,x.useQuery)(["audit-log",g],()=>p(g),{onError(){l({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),s()}}),i=G(),L=r?i(r.date):"";return e.createElement(B.P,{onClose:s,labelledBy:"title"},e.createElement(Q.x,null,e.createElement(W.O,{label:L,id:"title"},e.createElement(W.$,null,L))),e.createElement(N.f,null,e.createElement(ge,{status:d,data:r,formattedDate:L})))};k.propTypes={handleClose:n().func.isRequired,logId:n().string.isRequired};var pe=k,he=t(83196),Ee=t(21428),z=t(90333);const J=({value:s,options:g,onChange:u})=>{const{formatMessage:l}=(0,f.Z)(),p=l({id:"Settings.permissions.auditLogs.filter.aria-label",defaultMessage:"Search and select an option to filter"});return e.createElement(Ee.hQ,{"aria-label":p,value:s,onChange:u},g.map(({label:r,customValue:d})=>e.createElement(z.O,{key:d,value:d},r)))};J.defaultProps={value:null},J.propTypes={value:n().string,options:n().arrayOf(n().shape({label:n().string.isRequired,customValue:n().string.isRequired}).isRequired).isRequired,onChange:n().func.isRequired};var q=J;const Y=[{intlLabel:{id:"components.FilterOptions.FILTER_TYPES.$eq",defaultMessage:"is"},value:"$eq"},{intlLabel:{id:"components.FilterOptions.FILTER_TYPES.$ne",defaultMessage:"is not"},value:"$ne"}];var te=({formatMessage:s,users:g,canReadUsers:u})=>{const l=Object.keys(w).map(r=>({label:s({id:`Settings.permissions.auditLogs.${r}`,defaultMessage:Z(r)},{model:void 0}),customValue:r})),p=[{name:"action",metadatas:{customOperators:Y,label:s({id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"}),options:l,customInput:q},fieldSchema:{type:"enumeration"}},{name:"date",metadatas:{label:s({id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"})},fieldSchema:{type:"datetime"}}];if(u&&g){const r=i=>i.username?i.username:i.firstname&&i.lastname?s({id:"Settings.permissions.auditLogs.user.fullname",defaultMessage:"{firstname} {lastname}"},{firstname:i.firstname,lastname:i.lastname}):i.email,d=g.map(i=>({label:r(i),customValue:i.id.toString()}));return[...p,{name:"user",metadatas:{customOperators:Y,label:s({id:"Settings.permissions.auditLogs.user",defaultMessage:"User"}),options:d,customInput:q},fieldSchema:{type:"relation",mainField:{name:"id"}}}]}return p},fe=t(53038),ae=t(19150),se=({canReadAuditLogs:s,canReadUsers:g})=>{const{get:u}=(0,o.kY)(),{search:l}=(0,fe.TH)(),p=(0,o.lm)(),r={keepPreviousData:!0,retry:!1,staleTime:1e3*20,onError:I=>p({type:"warning",message:I.message})},{users:d,isError:i,isLoading:L}=(0,ae.R)({},{...r,enabled:g,staleTime:2*(1e3*60)}),{data:C,isLoading:$,isError:K}=(0,x.useQuery)(["auditLogs",l],async({queryKey:I})=>{const Le=I[1],{data:Me}=await u(`/admin/audit-logs${Le}`);return Me},{...r,enabled:s});return{auditLogs:C,users:d,isLoading:L||$,hasError:K||i}};const ye={...h.Z.settings.auditLogs,readUsers:h.Z.settings.users.read};var ne=()=>{const{formatMessage:s}=(0,f.Z)(),{allowedActions:{canRead:g,canReadUsers:u}}=(0,o.ss)(ye),[{query:l},p]=(0,o.Kx)(),{auditLogs:r,users:d,isLoading:i,hasError:L}=se({canReadAuditLogs:g,canReadUsers:u});(0,o.go)();const C=te({formatMessage:s,users:d,canReadUsers:u}),$=s({id:"global.auditLogs",defaultMessage:"Audit Logs"}),K=de.map(I=>({...I,metadatas:{...I.metadatas,label:s(I.metadatas.label)}}));return L?e.createElement(c.A,null,e.createElement(E.D,null,e.createElement(v.x,{paddingTop:8},e.createElement(o.Hn,null)))):e.createElement(M.o,{"aria-busy":i},e.createElement(o.SL,{name:$}),e.createElement(P.T,{title:$,subtitle:s({id:"Settings.permissions.auditLogs.listview.header.subtitle",defaultMessage:"Logs of all the activities that happened in your environment"})}),e.createElement(R.Z,{startActions:e.createElement(he.Z,{displayedFilters:C})}),e.createElement(E.D,{canRead:g},e.createElement(o.tM,{contentType:"Audit logs",headers:K,rows:r?.results||[],withBulkActions:!0,isLoading:i},e.createElement(le,{headers:K,rows:r?.results||[],onOpenModal:I=>p({id:I})})),e.createElement(a,{pagination:r?.pagination})),l?.id&&e.createElement(pe,{handleClose:()=>p({id:null},"remove"),logId:l.id}))},oe=()=>e.createElement(o.O4,{permissions:h.Z.settings.auditLogs.main},e.createElement(ne,null))},11299:function(S,y,t){t.d(y,{$:function(){return P},O:function(){return R}});var e=t(74512),o=t(77277),h=t(8471),f=t(3685),c=t(87933),E=t(72850),v=t(49372);const M=(0,h.ZP)(c.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:m})=>m.colors.neutral500};
    }
  }
  :last-of-type ${E.x} {
    display: none;
  }
  :last-of-type ${v.Z} {
    color: ${({theme:m})=>m.colors.neutral800};
    font-weight: ${({theme:m})=>m.fontWeights.bold};
  }
`,P=({children:m})=>(0,e.jsxs)(M,{inline:!0,as:"li",children:[(0,e.jsx)(v.Z,{variant:"pi",textColor:"neutral600",children:m}),(0,e.jsx)(E.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,e.jsx)(o.Z,{})})]});P.displayName="Crumb";const R=({children:m,label:n,...j})=>(0,e.jsxs)(c.k,{...j,children:[(0,e.jsx)(f.T,{children:n}),(0,e.jsx)("ol",{"aria-hidden":!0,children:m})]});R.displayName="Breadcrumbs"},21428:function(S,y,t){t.d(y,{Wx:function(){return de},XU:function(){return Pe},hQ:function(){return X}});var e=t(74512),o=t(32735),h=t(35331),f=t(16899),c=t(42345),E=t(8471),v=t(14268),M=t(95976),P=t(74971),R=t(36971),m=t(30350),n=t(23866),j=t(72850),T=t(49372),A=t(87107),D=t(87933),_=t(28847),re=t(67014),ie=t(47851);const X=({children:a,clearLabel:x="clear",creatable:B=!1,createMessage:Q=s=>`Create "${s}"`,defaultFilterValue:W,defaultTextValue:N,defaultOpen:ue=!1,open:ce,onOpenChange:me,disabled:F=!1,error:b,filterValue:H,hasMoreItems:ge=!1,hint:k,id:pe,label:he,labelAction:Ee,loading:z=!1,loadingMessage:J="Loading content...",noOptionsMessage:q=()=>"No results found",onChange:Y,onClear:ee,onCreateOption:te,onFilterValueChange:fe,onInputChange:ae,onTextValueChange:xe,onLoadMore:se,placeholder:ye="Select or enter a value",required:ve=!1,startIcon:ne,textValue:Ce,value:oe})=>{const[s,g]=(0,M.T)({prop:ce,defaultProp:ue,onChange:me}),[u,l]=(0,M.T)({prop:Ce,defaultProp:N,onChange:xe}),[p,r]=(0,M.T)({prop:H,defaultProp:W,onChange:fe}),d=o.useRef(null),i=o.useRef(null),L=o.useRef(null),C=(0,P.M)(pe),$=O=>{ee&&!F&&(l(""),r(""),ee(O),i.current.focus())},K=O=>{g(O)},I=O=>{l(O)},Le=O=>{r(O)},Me=O=>{ae&&ae(O)},Re=O=>{Y&&Y(O)},je=(0,P.M)(),Oe=`intersection-${(0,v.B)(je)}`,Ae=O=>{se&&ge&&!z&&se(O)},Te=()=>{te&&u&&te(u)};(0,R.s)(d,Ae,{selectorToWatch:`#${Oe}`,skipWhen:!s});const Ie=`${C}-hint`,$e=`${C}-error`;return(0,e.jsx)(A.g,{hint:k,error:b,id:C,required:ve,children:(0,e.jsxs)(D.k,{direction:"column",alignItems:"stretch",gap:1,children:[(0,e.jsx)(_.Q,{action:Ee,children:he}),(0,e.jsxs)(c.hQ.Root,{autocomplete:B?"list":"both",open:s,onOpenChange:K,onTextValueChange:I,textValue:u,allowCustomValue:!0,disabled:F,required:ve,value:oe===null?void 0:oe,onValueChange:Re,filterValue:p,onFilterValueChange:Le,children:[(0,e.jsxs)(w,{$hasError:!!b,children:[(0,e.jsxs)(D.k,{flex:"1",as:"span",gap:3,children:[ne?(0,e.jsx)(j.x,{as:"span","aria-hidden":!0,children:ne}):null,(0,e.jsx)(Z,{placeholder:ye,id:C,"aria-invalid":!!b,"aria-labelledby":`${Ie} ${$e}`,onChange:Me,ref:i})]}),(0,e.jsxs)(D.k,{as:"span",gap:3,children:[u&&ee?(0,e.jsx)(G,{as:"button",hasRadius:!0,background:"transparent",type:"button",onClick:$,"aria-disabled":F,"aria-label":x,title:x,ref:L,children:(0,e.jsx)(h.Z,{})}):null,(0,e.jsx)(V,{children:(0,e.jsx)(f.Z,{})})]})]}),(0,e.jsx)(c.hQ.Portal,{children:(0,e.jsx)(le,{sideOffset:4,children:(0,e.jsxs)(De,{ref:d,children:[a,B?(0,e.jsx)(c.hQ.CreateItem,{onPointerUp:Te,onClick:Te,asChild:!0,children:(0,e.jsx)(U,{children:(0,e.jsx)(T.Z,{children:Q(u??"")})})}):null,!B&&!z?(0,e.jsx)(c.hQ.NoValueFound,{asChild:!0,children:(0,e.jsx)(U,{$hasHover:!1,children:(0,e.jsx)(T.Z,{children:q(u??"")})})}):null,z?(0,e.jsx)(D.k,{justifyContent:"center",alignItems:"center",paddingTop:2,paddingBottom:2,children:(0,e.jsx)(n.a,{small:!0,children:J})}):null,(0,e.jsx)(j.x,{id:Oe,width:"100%",height:"1px"})]})})})]}),(0,e.jsx)(re.J,{}),(0,e.jsx)(ie.c,{})]})})},Pe=a=>(0,e.jsx)(X,{...a,creatable:!0}),G=(0,E.ZP)(j.x)`
  border: none;

  svg {
    height: ${11/16}rem;
    width: ${11/16}rem;
  }

  svg path {
    fill: ${({theme:a})=>a.colors.neutral600};
  }
`,w=(0,E.ZP)(c.hQ.Trigger)`
  position: relative;
  border: 1px solid ${({theme:a,$hasError:x})=>x?a.colors.danger600:a.colors.neutral200};
  padding-right: ${({theme:a})=>a.spaces[3]};
  padding-left: ${({theme:a})=>a.spaces[3]};
  border-radius: ${({theme:a})=>a.borderRadius};
  background: ${({theme:a})=>a.colors.neutral0};
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: ${({theme:a})=>a.spaces[4]};

  &[data-disabled] {
    color: ${({theme:a})=>a.colors.neutral600};
    background: ${({theme:a})=>a.colors.neutral150};
    cursor: not-allowed;
  }

  /* Required to ensure the below inputFocusStyles are adhered too */
  &:focus-visible {
    outline: none;
  }

  ${({theme:a,$hasError:x})=>(0,m.k3)()({theme:a,hasError:x})};
`,Z=(0,E.ZP)(c.hQ.TextInput)`
  width: 100%;
  font-size: ${14/16}rem;
  color: ${({theme:a})=>a.colors.neutral800};
  min-height: ${40/16}rem;
  border: none;
  background-color: transparent;

  &:focus-visible {
    outline: none;
  }

  &[aria-disabled='true'] {
    cursor: inherit;
  }
`,V=(0,E.ZP)(c.hQ.Icon)`
  & > svg {
    width: ${6/16}rem;

    & > path {
      fill: ${({theme:a})=>a.colors.neutral600};
    }
  }

  &[aria-disabled='true'] {
    cursor: inherit;
  }
`,le=(0,E.ZP)(c.hQ.Content)`
  background: ${({theme:a})=>a.colors.neutral0};
  box-shadow: ${({theme:a})=>a.shadows.filterShadow};
  border: 1px solid ${({theme:a})=>a.colors.neutral150};
  border-radius: ${({theme:a})=>a.borderRadius};
  width: var(--radix-combobox-trigger-width);
  /* This is from the design-system figma file. */
  max-height: 15rem;
  z-index: ${({theme:a})=>a.zIndices[1]};
`,De=(0,E.ZP)(c.hQ.Viewport)`
  padding: ${({theme:a})=>a.spaces[1]};
`,de=o.forwardRef(({children:a,value:x,disabled:B,textValue:Q,...W},N)=>(0,e.jsx)(c.hQ.ComboboxItem,{asChild:!0,value:x,disabled:B,textValue:Q,children:(0,e.jsx)(U,{ref:N,...W,children:(0,e.jsx)(c.hQ.ItemText,{asChild:!0,children:(0,e.jsx)(T.Z,{children:a})})})})),U=E.ZP.div`
  width: 100%;
  border: none;
  text-align: left;
  outline-offset: -3px;
  padding: ${({theme:a})=>a.spaces[2]} ${({theme:a})=>a.spaces[4]};
  background-color: ${({theme:a})=>a.colors.neutral0};
  border-radius: ${({theme:a})=>a.borderRadius};
  user-select: none;

  &[data-selected] {
    background-color: ${({theme:a})=>a.colors.primary100};

    ${T.Z} {
      color: ${({theme:a})=>a.colors.primary600};
      font-weight: bold;
    }
  }

  &:hover,
  &[data-highlighted] {
    outline: none;
    background-color: ${({theme:a,$hasHover:x=!0})=>x?a.colors.primary100:a.colors.neutral0};
  }

  &[data-highlighted] {
    ${T.Z} {
      color: ${({theme:a})=>a.colors.primary600};
      font-weight: bold;
    }
  }
`},90333:function(S,y,t){t.d(y,{O:function(){return o}});var e=t(21428);const o=e.Wx},99223:function(S,y,t){t.d(y,{Z:function(){return h}});var e=t(74512),o=t(87933);const h=({startActions:f,endActions:c})=>!f&&!c?null:(0,e.jsxs)(o.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(o.k,{gap:2,wrap:"wrap",children:f}),(0,e.jsx)(o.k,{gap:2,shrink:0,wrap:"wrap",children:c})]})}}]);
